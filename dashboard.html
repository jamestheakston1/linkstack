document.getElementById('add-link-btn').addEventListener('click', async () => {
    const label = document.getElementById('link-label').value.trim();
    const url = document.getElementById('link-url').value.trim();
    
    if(!label || !url) return showModal("Error", "Please fill in all fields", "alert-circle");

    // We now know for sure the column is 'profile_id'
    const { error } = await supabaseClient
        .from('links')
        .insert([{ 
            profile_id: currentUser.id, 
            label: label, 
            url: url, 
            order_index: cachedLinks.length 
        }]);

    if(error) {
        console.error(error);
        showModal("Error", "Database error: " + error.message, "x-octagon");
    } else {
        document.getElementById('link-label').value = '';
        document.getElementById('link-url').value = '';
        await loadAll(); // Refresh the list
        showModal("Success", "Link added!", "check");
    }
});
